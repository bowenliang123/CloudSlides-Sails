// Generated by CoffeeScript 1.7.1
(function() {
  angular.module('mypptCtrl', ['User', 'Ppt', 'angularFileUpload']).controller('mypptCtrl', function($scope, $upload, User, Ppt) {
    var init;
    $scope.onFileSelect = function($files) {
      var pptFile;
      pptFile = $files[0];
      $scope.isUploading = true;
      return $scope.upload = $upload.upload({
        url: '/ppt/upload',
        method: 'POST',
        headers: User.genAuthHeader(),
        data: {
          userId: User.getUserId(),
          size: pptFile.size,
          type: pptFile.type,
          fileName: pptFile.name
        },
        file: pptFile
      }).progress(function(evt) {
        var percent;
        percent = parseInt(100.0 * evt.loaded / evt.total);
        console.log('percent: ' + percent);
        return $scope.progress = percent;
      }).success(function(data, status, headers, config) {
        console.log(data);
        $scope.isUploading = false;
        return $scope.refreshPptsData();
      });
    };
    $scope.refreshPptsData = function() {
      return Ppt.query({
        owner: User.getUserId()
      }, function(value, responseHeaders) {
        return $scope.ppts = value;
      }, function(httpResponse) {});
    };
    $scope.deletePpt = function(pptId) {
      return Ppt["delete"]({
        pptId: pptId
      }, {}, function(value, responseHeaders) {
        console.log(value);
        if (value.status === 0) {
          alert('删除成功');
          return $scope.refreshPptsData();
        }
      }, function(httpResponse) {});
    };
    init = function() {
      $scope.isUploading = false;
      $scope.ppts = [];
      $scope.progress = 0;
      return $scope.refreshPptsData();
    };
    return init();
  });

}).call(this);

//# sourceMappingURL=mypptCtrl.map
