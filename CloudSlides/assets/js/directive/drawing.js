// Generated by CoffeeScript 1.7.1
(function() {
  angular.module('drawing', []).directive("drawing", function() {
    return {
      restrict: "A",
      link: function(scope, element, attrs) {
        var ctx, draw, drawing, lastX, lastY, onDown, onMove, onUp, reset;
        reset = function() {
          element[0].width = element[0].width;
        };
        draw = function(lX, lY, cX, cY, color) {
          if (color == null) {
            color = "#4bf";
          }
          ctx.moveTo(lX, lY);
          ctx.lineTo(cX, cY);
          ctx.strokeStyle = color;
          ctx.stroke();
        };
        ctx = element[0].getContext("2d");
        drawing = false;
        lastX = void 0;
        lastY = void 0;
        onDown = function(event) {
          if (event.offsetX !== undefined) {
            lastX = event.offsetX;
            lastY = event.offsetY;
          } else {
            lastX = event.layerX - event.currentTarget.offsetLeft;
            lastY = event.layerY - event.currentTarget.offsetTop;
          }
          ctx.beginPath();
          return drawing = true;
        };
        onMove = function(event) {
          var currentX, currentY;
          if (drawing) {
            if (event.offsetX !== undefined) {
              currentX = event.offsetX;
              currentY = event.offsetY;
            } else {
              currentX = event.layerX - event.currentTarget.offsetLeft;
              currentY = event.layerY - event.currentTarget.offsetTop;
            }
            draw(lastX, lastY, currentX, currentY);
            lastX = currentX;
            return lastY = currentY;
          }
        };
        onUp = function(event) {
          return drawing = false;
        };
        element.bind("mousedown", function(event) {
          onDown(event);
        });
        element.bind("mousemove", function(event) {
          onMove(event);
        });
        element.bind("mouseup", function(event) {
          onUp(event);
        });
        element.bind("touchstart", function(event) {
          onDown(event);
        });
        element.bind("touchmove", function(event) {
          onMove(event);
        });
        element.bind("touchend", function(event) {
          onUp(event);
        });
      }
    };
  });

}).call(this);

//# sourceMappingURL=drawing.map
